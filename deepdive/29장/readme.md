# 자바스크립트 배열은 배열이 아니다


## 일반적인 배열이란?
배열(array)은 같은 타입의 변수들로 이루어진 유한 집합

## V8에서의 배열 관련 내용

Fast elements : 키 집합이 매우 컴팩트 한 배열로 설계되었습니다. 이것은 매우 효율적으로 액세스 할 수 있는 linear storage buffer를 가집니다.

Dictionary elements : 내부에 모든 요소가 없는 희소 배열 용으로 설계되었습니다. 실제로는 hash table 입니다. "Fast Elements" 보다 접근하는데 비용이 더 비쌉니다.



## 자바스크립트의 배열은?
기본적으로 자바스크립트 엔진은 데이터 프로퍼티를 생성시 프로퍼티의 상태를 나타내는 프로퍼티 어트리뷰트를 기본값으로 자동 정의한다.

프로퍼티 상태
- value : 프로퍼티의 값
- writable : 값의 갱신 가능 여부
- enumerable : 열거 가능 여부
- configurable : 재정의 가능 여부


배열의 요소는 하나의 타입으로 통일되어 있으며 서로 연속적으로 인접해 있다. 이러한 배열을 밀집 배열이라 한다.

> 검색 대상 요소의 메모리 주소 = 배열의 시작 메모리 주소 + 인덱스 * 요소의 바이트 수

정렬되어있는 경우 인덱스 값이 각 요소의 크기가 플러스된 값으로 이뤄져있기때문에 시간 복잡도가 O(1)이다.

배열의 크기(length)와 요소의 수가 같지 않는 배열을 희소 배열이라고 칭한다.

일반적인 배열과 자바스크립트 배열의 장단점
- 일반적인 배열은 인덱스로 배열 요소에 빠르게 접근할 수 있다. 하지만 특정 요소를 탐색하거나 요소를 삽입 또는 삭제하는 경우에는 효율적이지 않다.
- 자바스크립트 배열은 해시 테이블로 구현된 객체이므로 인덱스로 배열 요소에 접근하는 경우, 일반적인 배열보다 성능적인 면에서 느릴 수 밖에 없는 구조적인 단점을 갖는다. 하지만 특정 요소를 탐색하거나 요소를 삽입 또는 삭제하는 경우에는 일반적인 배열보다 빠른 성능을 기대할 수 있다.

> 특정요소를 탐색하거나 요소를 삽입 또는 삭제하는 경우에는 일반적인 배열보다 빠르다.

이처럼 인덱스로 배열 요소에 접근할 때 일반적인 배열보다 느릴 수 밖에 없는 구조적인 단점을 보완하기 위해 대부분의 모던 자바스크립트 엔진은 배열을 일반 객체와 구별하여 보다 배열처럼 동작하도록 최적화하여 구현하였다.

## 배열안에 프로퍼티를 지정하는 경우
```
const arr = [1,2,3];
arr.check1 = "test";

```
이경우 자바스크립트 엔진은 배열을 일반객체처럼 다루게 되면서 최적화 기법이 동작하지 않아 배열 특유의 이점이 사라지게 됩니다. (???)



